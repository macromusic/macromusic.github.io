<!DOCTYPE html>
  <html lang="ja">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>Document</title>
    </head>
    <body>
      <div>MacroSample</div>
      <pre>
Option Explicit
Option Base 1

'◆ClassProc名_データ演算クラスのInterface構文
'Rev.002
  
'//モジュールメモリ
  Private Const meMstrMdlName As String = "IntfcSgnlPrcs"

'Interface_変数(Object型以外)出力用のプロパティ
Public Property Get ifgetOptnBase() As Long
End Property

'Interface_変数(Object型以外)出力用のプロパティ
Public Property Get ifgetCmpltFlag() As Boolean
End Property

'Interface_変数(Object型以外)出力用のプロパティ
Public Property Get ifgetCalDataCnt() As Long
End Property

'Interface_変数(Object型以外)出力用のプロパティ
Public Property Get ifgetCalDataAry(ByVal i As Long, ByVal j As Long) As Variant
End Property

'Interface_変数(Object型以外)入力用のプロパティ
Public Property Let ifletOrgDataAry(ByRef RHS() As Double)
End Property

'Interface_変数(Object型以外)入力用のプロパティ
Public Property Let ifletCalParaAry(ByRef RHS() As Variant)
End Property

'Interface_変数(Object型)入力用のプロパティ
Public Property Set ifsetPstFrstCell(ByVal RHS As Object)
End Property

'Interface_Control処理
Public Sub ifControlProc()
End Sub

'===============================================================================================

''◆ClassProc名_データ演算クラスのInterface構文
'Private Sub instIntfcSgnlPrcs()
'  Dim Lc As Long
'  Dim myXbisCmpltFlag As Boolean
'  Dim myXlonCalDataCnt As Long, myZvarCalData() As Variant
'    'myZvarCalData(i, 1) : 演算結果データ
''//クラス内変数への入力
'  Dim myZdouOrgData() As Double, myZvarCalPara() As Variant
'    'myZdouOrgData(i, 1) : 元データ
'    'myZvarCalPara(i, 1) : 演算用パラメータ
'  Dim myXobjPstFrstCell As Object
'  Dim myXobjPstSht As Object, myXlonPstFrstRow As Long, myXlonPstFrstCol As Long
'    ReDim myZdouOrgData(1, 1) As Double
'    ReDim myZvarCalPara(1, 1) As VariantW
'    myZdouOrgData(1, 1) = 1
'    myZvarCalPara(1, 1) = 2
'    Set myXobjPstSht = ActiveSheet
'    myXlonPstFrstRow = 5
'    myXlonPstFrstCol = 3
'    Set myXobjPstFrstCell = myXobjPstSht.Cells(myXlonPstFrstRow, myXlonPstFrstCol)
''//IntfcSgnlPrcsクラスモジュールのインスタンス生成
'  Dim myZlonTmp(1) As Long, Lo As Long: Lo = LBound(myZlonTmp)
'  Dim i As Long
'  Dim myXinsIntfcSgnlPrcs As IntfcSgnlPrcs: Set myXinsIntfcSgnlPrcs = New IntfcSgnlPrcs
'    With myXinsIntfcSgnlPrcs
'    '//クラス内変数への入力
'        .ifletOrgDataAry() = myZdouOrgData()
'        .ifletCalParaAry() = myZvarCalPara()
'        Set .ifsetPstFrstCell = myXobjPstFrstCell
'    '//クラス内プロシージャの実行とクラス内変数からの出力
'        .ifControlProc
'        myXbisCmpltFlag = .ifgetCmpltFlag
'        myXlonCalDataCnt = .ifgetCalDataCnt
'        If myXlonCalDataCnt <= 0 Then GoTo JumpPath
'        i = myXlonCalDataCnt + Lo - 1
'        ReDim myZvarCalData(i, Lo) As Variant
'        Lc = .ifgetOptnBase
'        For i = 1 To myXlonCalDataCnt
'            myZvarCalData(i + Lo - 1, Lo) = .ifgetCalDataAry(i + Lc - 1, Lc)
'        Next i
'    End With
'JumpPath:
'    Set myXinsIntfcSgnlPrcs = Nothing
'    Call variablesOfIntfcSgnlPrcs(myXlonCalDataCnt, myZvarCalData)  'Debug.Print
'End Sub
'Private Sub variablesOfIntfcSgnlPrcs( _
'            ByVal myXlonDataCnt As Long, ByRef myZvarField As Variant)
''//IntfcSgnlPrcsクラス内から出力した変数の内容確認
'    Debug.Print "データ数: " & myXlonDataCnt
'    If myXlonDataCnt <= 0 Then Exit Sub
'  Dim k As Long
'    For k = LBound(myZvarField, 1) To UBound(myZvarField, 1)
'        Debug.Print "データ" & k & ": " & myZvarField(k, 1)
'    Next k
'End Sub

      <br></pre>
    </body>
  </html>
