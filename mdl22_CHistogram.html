<!DOCTYPE html>
  <html lang="ja">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>Document</title>
    </head>
    <body>
      <div>MacroSample</div>
      <pre>
Option Explicit
Option Base 1

'◆ClassProc名_分布データ一覧から度数分布表データを生成する
Private Sub PforNewInstanceOfCHistogram()
  Dim Lc As Long
  Dim myXlonHstCnt As Long, myZdouHstData() As Double
    'myZdouHstData(i, 1) : 取得したヒストグラムデータのパラメータ
    'myZdouHstData(i, 2) : 取得したヒストグラムデータの度数
'//クラス内変数への入力
  Dim myXlonOrgDataCnt As Long, myZdouOrgData() As Double
    'myZdouOrgData(i) : 元データ配列
    myXlonOrgDataCnt = 2
    ReDim myZdouOrgData(myXlonOrgDataCnt, 1) As Double
    myZdouOrgData(1, 1) = 1
    myZdouOrgData(2, 1) = 0.5
  Dim myXdouHstBgnVal As Double, myXdouHstEndVal As Double, myXdouHstStpVal As Double
    'myXdouHstBgnVal : 度数分布表のデータ範囲の最初の値
    'myXdouHstEndVal : 度数分布表のデータ範囲の最後の値
    'myXdouHstStpVal : 度数分布表のデータ分割値
'    myXdouHstBgnVal = 0
'    myXdouHstEndVal = 2
'    myXdouHstStpVal = (myXdouHstEndVal - myXdouHstBgnVal) / 10
'//CHistogramクラスモジュールのインスタンス生成
  Dim myZlonTmp(1) As Long, Lo As Long: Lo = LBound(myZlonTmp)
  Dim i As Long, j As Long
  Dim myXinsHistogram As CHistogram: Set myXinsHistogram = New CHistogram
    With myXinsHistogram
    '//クラス内変数への入力
        .letOrgDataAry = myZdouOrgData
        .letHstBgnVal = myXdouHstBgnVal
        .letHstEndVal = myXdouHstEndVal
        .letHstStpVal = myXdouHstStpVal
    '//クラス内プロシージャの実行とクラス内変数からの出力
        .exeProc
        myXlonHstCnt = .getHstCnt
        If myXlonHstCnt <= 0 Then GoTo JumpPath
        i = myXlonHstCnt + Lo - 1: j = Lo + 1
        ReDim myZdouHstData(i, j) As Double
        Lc = .getOptnBase
        For i = 1 To myXlonHstCnt
            myZdouHstData(i + Lo - 1, Lo + 0) = .getHstDataAry(i + Lc - 1, Lc + 0)
            myZdouHstData(i + Lo - 1, Lo + 1) = .getHstDataAry(i + Lc - 1, Lc + 1)
        Next i
    End With
JumpPath:
    Set myXinsHistogram = Nothing
    Call PforDisplayVariablesOfCHistogram(myXlonHstCnt, myZdouHstData)  'Debug.Print
End Sub
Private Sub PforDisplayVariablesOfCHistogram( _
            ByVal myXlonDataCnt As Long, ByRef myZvarField As Variant)
'//CHistogramクラス内から出力した変数の内容確認
    Debug.Print "データ数: " & myXlonDataCnt
    If myXlonDataCnt <= 0 Then Exit Sub
  Dim i As Long, j As Long
    For i = LBound(myZvarField, 1) To UBound(myZvarField, 1)
        For j = LBound(myZvarField, 2) To UBound(myZvarField, 2)
            Debug.Print "データ" & i & "," & j & ": " & myZvarField(i, j)
        Next j
    Next i
End Sub

      <br></pre>
    </body>
  </html>
