<!DOCTYPE html>
  <html lang="ja">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      <title>Document</title>
    </head>
    <body>
      <div>MexeHypLnkBase</div>
      <pre>
Option Explicit
Option Base 1

'◆ModuleProc名_エクセルブック内のハイパーリンク起点を変更する
'Rev.001
  
'//モジュールメモリ
  Private Const meMstrMdlName As String = "MexeHypLnkBase"

'PublicP_ハイパーリンクの基点にアクティブブックの親パスを設定する
Public Sub exeProc1()
    
'//処理実行
  Dim myXstrNewBase As String, myXobjBook As Object
    Set myXobjBook = ActiveWorkbook
    myXstrNewBase = myXobjBook.Path
  Dim myXbisExitFlag As Boolean

'//ハイパーリンク基点を変更する時にメッセージボックスを表示
    Call PfixMsgBoxHyperLinkBaseChange(myXbisExitFlag, myXstrNewBase, myXobjBook)
    
''/ハイパーリンク基点を変更する時に選択ボックスを表示
'    Call PfixYesNoCancelHyperLinkBaseChange(myXbisExitFlag, myXstrNewBase, myXobjBook)
    
'//処理結果表示
    Select Case myXbisExitFlag
        Case False: MsgBox "実行完了"
        Case Else: MsgBox "異常あり", vbExclamation
    End Select

    Set myXobjBook = Nothing
End Sub

'PublicP_ハイパーリンクの基点に空白を設定する
Public Sub exeProc2()
    
'//処理実行
  Dim myXstrNewBase As String, myXobjBook As Object
    Set myXobjBook = ActiveWorkbook
    myXstrNewBase = ""
  Dim myXbisExitFlag As Boolean

'//ハイパーリンク基点を変更する時にメッセージボックスを表示
    Call PfixMsgBoxHyperLinkBaseChange(myXbisExitFlag, myXstrNewBase, myXobjBook)
    
''/ハイパーリンク基点を変更する時に選択ボックスを表示
'    Call PfixYesNoCancelHyperLinkBaseChange(myXbisExitFlag, myXstrNewBase, myXobjBook)
    
'//処理結果表示
    Select Case myXbisExitFlag
        Case False: MsgBox "実行完了"
        Case Else: MsgBox "異常あり", vbExclamation
    End Select

    Set myXobjBook = Nothing
End Sub

'===============================================================================================

 '定型Ｐ_ハイパーリンク基点を変更する時に選択ボックスを表示する
Private Sub PfixYesNoCancelHyperLinkBaseChange( _
            myXbisExitFlag As Boolean, _
            ByVal myXstrNewBase As String, ByVal myXobjBook As Object)
  Const coXstrBkPrptyName As String = "Hyperlink base"
    myXbisExitFlag = False
'//指定パスとプロパティのハイパーリンクの基点を比較
    On Error GoTo ExitPath
  Dim myXstrPrsntBase As String
    myXstrPrsntBase = myXobjBook.BuiltinDocumentProperties(coXstrBkPrptyName).Value
    If myXstrNewBase = myXstrPrsntBase Then Exit Sub
'//ハイパーリンクの基点変更の確認
  Dim myXstrMsgBox As Long, myXstrPrompt As String, myXstrTitle As String
    myXstrTitle = "はい/いいえ/キャンセルの選択"
    myXstrPrompt = "ハイパーリンクの基点を変更しますか？" & vbCrLf & vbCrLf _
                & "変更前：" & myXstrPrsntBase & vbCrLf _
                & " ↓ " & vbCrLf _
                & "変更後：" & myXstrNewBase & vbCrLf & vbCrLf _
                & "「はい」　　：基点を変更して継続" & vbCrLf _
                & "「いいえ」　 ：基点を変更せずに継続" & vbCrLf _
                & "「キャンセル」：プログラムを終了"
  Dim myXlonMsgBox As Long
    myXlonMsgBox = MsgBox(myXstrPrompt, vbYesNoCancel, myXstrTitle)
    Select Case myXlonMsgBox
        Case vbNo: Exit Sub
        Case vbCancel: GoTo ExitPath
    End Select
'//ブックのプロパティのハイパーリンクの基点を設定
    myXobjBook.BuiltinDocumentProperties(coXstrBkPrptyName).Value = myXstrNewBase
    On Error GoTo 0
    Exit Sub
ExitPath:
    myXbisExitFlag = True
End Sub

 '定型Ｐ_ハイパーリンク基点を変更する時にメッセージボックスを表示する
Private Sub PfixMsgBoxHyperLinkBaseChange( _
            myXbisExitFlag As Boolean, _
            ByVal myXstrNewBase As String, ByVal myXobjBook As Object)
  Const coXstrBkPrptyName As String = "Hyperlink base"
    myXbisExitFlag = False
'//ブックのパスとプロパティのハイパーリンクの基点を比較
    On Error GoTo ExitPath
  Dim myXstrPrsntBase As String
    myXstrPrsntBase = myXobjBook.BuiltinDocumentProperties(coXstrBkPrptyName).Value
    If myXstrNewBase = myXstrPrsntBase Then Exit Sub
'//ハイパーリンクの基点変更の確認
  Dim myXstrMsg As String
    myXstrMsg = "ハイパーリンクの基点を変更します。" & vbCrLf & vbCrLf _
                & "変更前：" & myXstrPrsntBase & vbCrLf _
                & " ↓ " & vbCrLf _
                & "変更後：" & myXstrNewBase
    MsgBox myXstrMsg
'//ブックのプロパティのハイパーリンクの基点を設定
    myXobjBook.BuiltinDocumentProperties(coXstrBkPrptyName).Value = myXstrNewBase
    On Error GoTo 0
    Exit Sub
ExitPath:
    myXbisExitFlag = True
End Sub

      <br></pre>
    </body>
  </html>
